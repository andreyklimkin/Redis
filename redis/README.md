# Redis server #

## Климкин Андрей БПМИ 141-2, ФКН, ВШЭ ##


## Цель - Реализовать собственный сервер, реализующий часть протокола redis ##

### Релизованный на данном этапе функционал: ###

1. Реализованы команды GET и SET
2. Реализован парсер для RedisValue
3. Сервер обрабатывает несколько клиентов одновременно
4. Snapshot - сохранение данных в единную базу данных, через лог фаил, восстановление данных при аварийном      завершении.


## Способы решения поставленных задач: ##

* ### Удалённый доступ к серверу(клиент-сервер технология) ###
   
   Обычные сокеты(гнёзда), Api, предоставляемый Unix системами, при при помощи сокетов клиент посылает запрос, на который от сервера приходит некоторый ответ. 

* ### Snapshot ###
   
   Сервис поддержиает единую, актуальную базу данных. Для аварийных ситуации используется технология Snapshot, аналогичная той, что используется в оригинальной версии redis server. Сервер записывает все последние изменения от клиентов в "changes". Затем каждые две секундны сбрасывает последние изменения в фаил "LastChanges", и при запуске все данные из "LastChanges" переносятся в основную базу данных, причём, если вдруг сервер завершил свою работу, то все последние изменения сразу же переносятся в основную базу данных. Для чтения данных использован низкоуровневый ввод, все данные в базе хранятся в виде L1 L2 Key Value, где L1 и L2 длинна строк Key и Value соответственно.


* ### Redis Protocol specification ###

   Все данные, которые поступают от клиента и возвращаются клиенту представлены в виде RESP. Тоесть, любой  клиент, использующий RESP может использовать дыннй сервис. Данный протокол был выбран, так как он прост в реализации, достаточно читабилен, и решает все трудности с поступлением и отправкой данных через TCP

   
* ### Обработка нескольких соединений ###

   Для решения данной задачи была испозьвована технология, предоставляемая POSIX API - неблокирующие сокеты + обработка при помощи системного вызова "select", для распознавания активных сокетов. Сервер обрабатывает поочередно каждого из активных клиентов, причём, данные от клиента, естественно, могут поступить не в полном объёме, для этого для каждого клиента сервер хранит текущее состояние обработки запроса, при помощи конечного автомата, чтобы при поступлении нового запроса от клиента, вернуться в былое состояние.


## Итог: ##

  Данный сервис предоставляет достаточно стабильную, эффективную базу данных для самых простых запросов вида GET + SET, что вполне может быть достаточным для некоторых технологий(приложений), использующих БД. При реализации данного проекта были более глубоко изучены возможности POSIX API, технология TCP, а также просто прокачен навык написания human-readable code(ну это по-моему беспристранному мнению :) ).